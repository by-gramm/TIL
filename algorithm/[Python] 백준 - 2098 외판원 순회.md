μ¶μ²: λ°±μ¤€ μ¨λΌμΈ μ €μ§€

https://www.acmicpc.net/problem/2098

<br>

___

## π“ƒ λ¬Έμ  μ„¤λ…

λ€ν‘μ μΈ μ•κ³ λ¦¬μ¦ λ¬Έμ  μ¤‘ ν•λ‚μΈ [TSP(traveling salesman problem)](https://en.wikipedia.org/wiki/Travelling_salesman_problem) λ¬Έμ λ‹¤.



1λ²λ¶€ν„° Nλ²κΉμ§€ λ²νΈκ°€ λ§¤κ²¨μ§„ λ„μ‹λ“¤μ΄ μλ‹¤. 

κ° λ„μ‹λ“¤ μ‚¬μ΄λ¥Ό μ΄λ™ν•  μ μλ” λΉ„μ©μ΄ ν–‰λ ¬ `W[i][j]` ν•νƒλ΅ μ£Όμ–΄μ§„λ‹¤.

`W[i][j]`λ” λ„μ‹ iμ—μ„ λ„μ‹ jλ΅ κ°€κΈ° μ„ν• λΉ„μ©μ΄λ‹¤.

- λ„μ‹ iμ—μ„ λ„μ‹ jλ΅ κ°€μ§€ λ»ν•  μλ„ μμΌλ©°, μ΄ κ²½μ° `W[i][j] = 0`μ΄λ‹¤.

- `W[i][j]`μ™€ `W[j][i]`λ” λ‹¤λ¥Ό μ μλ‹¤.



Nκ°μ λ„μ‹λ¥Ό λ¨λ‘ κ±°μ³ λ‹¤μ‹ μ›λμ λ„μ‹λ΅ λμ•„μ¤λ” μν μ—¬ν–‰ κ²½λ΅λ¥Ό κ³„νν•κ³ μ ν•λ‹¤.

- λ‹¨, λ§μ§€λ§‰μ— μ¶λ° λ„μ‹λ΅ λμ•„μ¤λ” κ²ƒμ„ μ μ™Έν•κ³ λ”, ν• λ² κ°”λ λ„μ‹λ΅λ” κ° μ μ—†λ‹¤.

- ν•­μƒ μνν•  μ μλ” κ²½μ°λ§ μ…λ ¥μΌλ΅ μ£Όμ–΄μ§„λ‹¤.

  

μ΄λ•, μ „μ²΄ λ„μ‹λ¥Ό μνν•λ” μµμ† λΉ„μ©μ„ κµ¬ν•λ‹¤.

<p align="center">
  <img src="algorithm.assets/tsp_example.png" width="50%" height="50%" />
</p>

μλ¥Ό λ“¤μ–΄, μ„ κ·Έλ¦Όμ—μ„λ” `2 => 1 => 3 => 4 => 2`λ΅ μνν•  λ•μ 12κ°€ μµμ† λΉ„μ©μ΄λ‹¤.

<br>

## π’΅ κΈ°λ³Έ μ•„μ΄λ””μ–΄

μ„ λ¬Έμ μ—μ„λ”, ν• λ„μ‹μ—μ„ μ‹μ‘ν•΄ λ¨λ“  λ„μ‹λ¥Ό μνν• λ’¤, μ›λ λ„μ‹λ΅ λμ•„μ¤λ” κ²½λ΅μ μµμ† λΉ„μ©μ„ κµ¬ν•λ‹¤.

κ·Έλ°λ° ν• λ„μ‹μ—μ„ μ¶λ°ν•΄ λ‹¤μ‹ κ·Έ λ„μ‹λ΅ λμ•„μ¤λ” μν κ²½λ΅μ—μ„λ”, μ‹μ‘ λ…Έλ“κ°€ μλ―Έκ°€ μ—†λ‹¤.

μλ¥Ό λ“¤μ–΄, `1 => 3 => 2 => 4 => 1`μ κ²½λ΅λ” `3 => 2 => 4 => 1 => 3`κ³Όλ„ κ°™κ³ , `2 => 4 => 1 => 3 => 2`μ™€λ„ κ°™λ‹¤. 

λ”°λΌμ„ μ„μμ ν• λ„μ‹λ¥Ό μ‹μ‘ κ²½λ΅λ΅ μ •ν•λ”λΌλ„, λ¨λ“  μν κ²½λ΅λ¥Ό νƒμƒ‰ν•  μ μλ‹¤.

<br>

## β° μ‹κ°„ μ΄κ³Ό ν’€μ΄ 1 - μ™„μ „ νƒμƒ‰

μ°μ„  λ¨λ“  κ²½μ°μ μλ¥Ό λ”°μ§€λ” λ°©μ‹μ„ μƒκ°ν•΄λ³΄μ. Nμ€ μµλ€ 16μ΄λ―€λ΅, λ„μ‹κ°€ 16κ°μΈ μƒν™©μ„ μƒκ°ν•΄λ³΄μ. μ„μμ ν• λ„μ‹λ¥Ό μ‹μ‘ κ²½λ΅λ΅ μ •ν•  μ μμΌλ―€λ΅ λ‚¨μ€ λ„μ‹λ” 15κ°λ‹¤. κ·ΈλΌ 15κ°μ λ„μ‹ μ¤‘ ν•λ‚λ¥Ό κ°„λ‹¤. κ·Έ λ‹¤μ λ‚¨μ€ 14κ°μ λ„μ‹ μ¤‘ ν•λ‚λ¥Ό κ°„λ‹¤. κ·Έ λ‹¤μ λ‚¨μ€ 13κ°μ λ„μ‹ μ¤‘ ν•λ‚λ¥Ό κ°„λ‹¤. μ΄λ ‡κ² λ§μ§€λ§‰ λ‚¨μ€ λ„μ‹κΉμ§€ λ¨λ‘ λ°©λ¬Έν•κ³  λ‹¤μ‹ μ‹μ‘ λ„μ‹λ΅ λμ•„κ°€λ” κ²½μ°μ μλ” `15!`μ΄λ‹¤. λ‹Ήμ—°ν•κ²λ„ μ΄ λ¨λ“  κ²½μ°λ¥Ό λ‹¤ κ²€μ‚¬ν•  μλ” μ—†λ‹¤.

<br>

## β° μ‹κ°„ μ΄κ³Ό ν’€μ΄ 2 - λ°±νΈλν‚Ή

λ¶ν•„μ”ν• νƒμƒ‰μ„ μ¤„μ΄κΈ° μ„ν•΄, λ°±νΈλν‚Ήμ„ μ΄μ©ν•΄λ³΄μ•λ‹¤. DFSλ΅ κ²½λ΅λ¥Ό νƒμƒ‰ν•λ©΄μ„ μ „μ²΄ λ„μ‹λ¥Ό μνν•λ” μµμ† λΉ„μ©μ„ `min_cost` λ³€μμ— μ €μ¥ν•΄κ°„λ‹¤. λ§μ•½ ν„μ¬κΉμ§€μ λΉ„μ©μ΄ `min_cost`λ³΄λ‹¤ ν¬λ‹¤λ©΄, ν•΄λ‹Ή κ²½λ΅λ¥Ό ν¬ν•¨ν•λ” κ²½λ΅λ” κ°€μ§€μΉκΈ°λ¥Ό ν•λ‹¤. 

μλ¥Ό λ“¤μ–΄, 5κ°μ λ„μ‹κ°€ μλ‹¤κ³  ν•μ. `1 => 2 => 3 => 4 => 5 => 1`λ΅ μνν•λ” λΉ„μ©μ΄ 100μ΄λ‹¤. κ·Έλ ‡λ‹¤λ©΄ `min_cost` λ³€μμ— 100μ„ ν• λ‹Ήν•λ‹¤. λ‹¤μμΌλ΅ `1 => 4 => 2`λ΅ μνν•λ” λΉ„μ©μ΄ 120μ΄λ‹¤. κ·Έλ ‡λ‹¤λ©΄ `1 => 4 => 2`λ΅ μ‹μ‘ν•λ” κ²½λ΅λ” νƒμƒ‰μ„ μ§„ν–‰ν•  ν•„μ”κ°€ μ—†λ‹¤.

μ΄λ ‡κ² κµ¬ν„ν•΄λ³΄μ•μΌλ‚, μ‹κ°„ μ΄κ³Όκ°€ λ–΄λ‹¤.

```python
from sys import stdin
from math import inf


N = int(stdin.readline())
board = []

for _ in range(N):
    board.append([int(x) for x in stdin.readline().split()])

visited = [False] * N
min_cost = inf
current = 0


def get_min_cost(cnt, cost, count):
    """
    Args:
        cnt: ν„μ¬ νƒμƒ‰ μ¤‘μΈ λ„μ‹μ λ²νΈ
        cost: ν„μ¬κΉμ§€μ μν λΉ„μ©
        count: ν„μ¬κΉμ§€ μνν• λ„μ‹μ κ°μ
    """
    global min_cost

    # μ „μ²΄ λ„μ‹λ¥Ό λ‹¤ μνν• κ²½μ° => μ²μ λ„μ‹λ΅ λμ•„κ°„λ‹¤.
    if count == N:
        if board[cnt][0]:
            min_cost = min(min_cost, cost + board[cnt][0])

        return

    for c in range(N):
        # μ•„μ§ cλ¥Ό λ°©λ¬Έν•μ§€ μ•μ•κ³ , ν„μ¬ μ„μΉμ—μ„ cλ΅ κ°€λ” κ²½λ΅κ°€ μλ‹¤λ©΄
        if not visited[c] and board[cnt][c]:
            # cλ΅ κ° λ•μ λΉ„μ©μ΄ min_costλ³΄λ‹¤ μ‘μ€ κ²½μ°μ—λ§ νƒμƒ‰ μ§„ν–‰
            if cost + board[cnt][c] < min_cost:
                visited[c] = True
                get_min_cost(c, cost + board[cnt][c], count + 1)
                visited[c] = False


get_min_cost(0, 0, 1)
print(min_cost)
```

<br>

## β° μ‹κ°„ μ΄κ³Ό ν’€μ΄ 3 - λΉ„νΈλ§μ¤ν‚Ή

λΉ„νΈλ§μ¤ν‚Ήμ„ μ‚΄μ§ μ¶”κ°€ν•΄λ³΄μ•μΌλ‚, ν° μ°¨μ΄λ” μ—†μ—λ‹¤.

```python
def get_min_cost(cnt, cost, visited):
    """
    Args:
        cnt: ν„μ¬ νƒμƒ‰ μ¤‘μΈ λ„μ‹μ λ²νΈ
    """
    global min_cost

    # μ „μ²΄ λ„μ‹λ¥Ό λ‹¤ μνν• κ²½μ° => μ²μ λ„μ‹λ΅ λμ•„κ°„λ‹¤.
    if visited == (2 ** N - 1):
        if board[cnt][0]:
            min_cost = min(min_cost, cost + board[cnt][0])

        return

    for c in range(N):
        # μ•„μ§ cλ¥Ό λ°©λ¬Έν•μ§€ μ•μ•κ³ , ν„μ¬ μ„μΉμ—μ„ cλ΅ κ°€λ” κ²½λ΅κ°€ μλ‹¤λ©΄
        if not (visited & (1 << c)) and board[cnt][c]:
            # cλ΅ κ° λ•μ λΉ„μ©μ΄ min_costλ³΄λ‹¤ μ‘μ€ κ²½μ°μ—λ§ νƒμƒ‰ μ§„ν–‰
            if cost + board[cnt][c] < min_cost:
                get_min_cost(c, cost + board[cnt][c], visited + (1 << c))


get_min_cost(0, 0, 1)
print(min_cost)
```

<br>

## π”“ μ •λ‹µ ν’€μ΄

κ²°κµ­ μλ ¥μΌλ΅λ” ν’€μ§€ λ»ν•μ—¬, μ •λ‹µ ν’€μ΄λ¥Ό μ°Έκ³ ν–λ‹¤.

(μ΄ν•μ ν’€μ΄λ” μ•„λμ κΈ€μ„ λ§μ΄ μ°Έμ΅°ν•μ—¬ μ‘μ„±λμ—μµλ‹λ‹¤.)

[TSP μ•κ³ λ¦¬μ¦ 2: λ™μ  κ³„νλ²• κµ¬ν„](https://shoark7.github.io/programming/algorithm/solve-tsp-with-dynamic-programming)

<br>

μ•μ„  μ ‘κ·Όμ„ ν†µν•΄ μ‹μ‘ κ²½λ΅λ” μ¤‘μ”ν•μ§€ μ•λ‹¤λ” κ²ƒμ„ μ•μ•λ‹¤. κ·Έλ¦¬κ³  λ°±νΈλν‚Ήκ³Ό λΉ„νΈλ§μ¤ν‚Ήμ„ ν†µν•΄ νƒμƒ‰μ„ μ¤„μ—¬λ³΄μ•μΌλ‚, μ‹κ°„ μ΄κ³Όκ°€ λ–΄λ‹¤. 



μ„ ν•΄μ„¤μ—μ„λ” μ‹κ°„μ„ μ¤„μ΄κΈ° μ„ν•΄ λ°±νΈλν‚Ήμ΄ μ•„λ‹λΌ **DP**λ¥Ό μ‚¬μ©ν•λ‹¤. DPμ—μ„ μ¤‘μ”ν• κ²ƒμ€ μ¤‘λ³µλλ” λ¶€λ¶„ λ¬Έμ λ¥Ό μ°Ύλ” μΌμ΄λ‹¤. TSP λ¬Έμ μ—μ„ μ¤‘λ³µλλ” λ¶€λ¶„ λ¬Έμ λ” λ¬΄μ—‡μΌκΉ?  `1 => 2 => 3`μ κ²½λ΅μ— μ΄μ–΄, `4`λ΅ κ°€λ” κ²½μ°μ™€, `1 => 3 => 2`μ— μ΄μ–΄ `4`λ΅ κ°€λ” κ²½μ°λ” κ°™μ€ κ²½λ΅μ— ν•΄λ‹Ήν•λ‹¤. μ¤‘κ°„ κ²½λ΅λ” μ¤‘μ”ν•μ§€ μ•μΌλ©°, κ°™μ€ λ„μ‹λ“¤μ„ κ±°μ³ κ°™μ€ λ„μ‹μ— λ„μ°©ν• κ²½λ΅μ΄κΈ° λ•λ¬Έμ΄λ‹¤. memoizationμ„ μ΄μ©ν•μ—¬, μ΄λ¬ν• μ¤‘λ³µλλ” μ—°μ‚°μ κ²°κ³Όλ¥Ό μ €μ¥ν•΄λ‘λ©΄, κ°™μ€ μ—°μ‚°μ„ λ°λ³µν•μ§€ μ•μ•„λ„ λ  κ²ƒμ΄λ‹¤.



κ·Έλ ‡λ‹¤λ©΄ ν„μ¬κΉμ§€ λ°©λ¬Έν• λ„μ‹λ“¤κ³Ό λ§μ§€λ§‰ λ°©λ¬Έ λ„μ‹κ°€ μ£Όμ–΄μ§ λ•, λ‚¨μ€ μνλ¥Ό λ§μΉλ” μµμ† λΉ„μ©μ„ κµ¬ν•λ” λ°©μ‹μΌλ΅ μ „μ²΄ μνμ μµμ† λΉ„μ©μ„ κµ¬ν•  μ μλ‹¤. κ·Έλ¦¬κ³  memoization λ°©μ‹μ„ μ΄μ©ν•μ—¬, ν•΄λ‹Ή λΉ„μ©μ„ μ €μ¥ν•΄λ‘λ©΄, μ¤‘λ³µ μ—°μ‚°μ„ ν”Όν•  μ μλ‹¤. μλ¥Ό λ“¤μ–΄, λ„μ‹κ°€ 1λ²λ¶€ν„° 7λ²κΉμ§€ μκ³ , ν„μ¬ `1 => 2 => 3 => 4`λ² μμΌλ΅ λ„μ‹λ¥Ό λ°©λ¬Έν–λ‹¤κ³  ν•μ. κ·Έλ ‡λ‹¤λ©΄ λ‚¨μ€ κ²½λ΅λ” 5, 6, 7λ² λ„μ‹λ¥Ό λ°©λ¬Έν• λ’¤, λ‹¤μ‹ 1λ² λ„μ‹λ΅ κ°€λ” κ²½λ΅λ‹¤. μ΄ κ²½λ΅μ μµμ† λΉ„μ©μ„ κµ¬ν• λ’¤, ν•΄λ‹Ή κ°’μ„ μ €μ¥ν•λ‹¤. κ·Έλ¬λ©΄ μ΄ν›„μ— `1 => 3 => 2 => 4`λ² μμΌλ΅ λ„μ‹λ¥Ό λ°©λ¬Έν• κ²½μ°, λ‚¨μ€ κ²½λ΅μ μµμ† λΉ„μ©μ„ λ°”λ΅ κµ¬ν•  μ μλ‹¤.



μ„μ μ•„μ΄λ””μ–΄λ¥Ό κµ¬ν„ν• μµμΆ… μ •λ‹µ μ½”λ“λ” μ•„λμ™€ κ°™λ‹¤.

```python
from sys import stdin
from math import inf


N = int(stdin.readline())
board = []

for _ in range(N):
    board.append([int(x) for x in stdin.readline().split()])

"""
costs: κ° λ„μ‹μ μ΅°ν•©μ— λ€ν•μ—¬, ν•΄λ‹Ή λ„μ‹λ“¤μ„ λ°©λ¬Έν• μƒνƒμ—μ„ λ‚¨μ€ λ„μ‹λ¥Ό λ¨λ‘ μνν•λ” μµμ† λΉ„μ©
       ex. costs[3][0b111001] => 3λ² λ„μ‹λ¥Ό λ§μ§€λ§‰μΌλ΅ (1, 2, 3, 6)λ² λ„μ‹λ¥Ό λ°©λ¬Έν• μƒνƒμ—μ„,
                                 λ‚¨μ€ λ„μ‹λ¥Ό λ¨λ‘ λ°©λ¬Έν•κ³  1λ² λ„μ‹λ΅ λμ•„μ¤λ” μµμ† λΉ„μ©
"""
costs = [[0] * (1 << N) for _ in range(N + 1)]


def get_min_cost(cnt, visited):
    """
    cntλ¥Ό λ§μ§€λ§‰μΌλ΅ visitedμ λ„μ‹λ“¤μ„ λ¨λ‘ λ°©λ¬Έν–μ„ λ•,
    λ‚¨μ€ μνλ¥Ό λ§μΉλ” μµμ† λΉ„μ©μ„ κµ¬ν•λ‹¤.

    Args:
        cnt: ν„μ¬ νƒμƒ‰ μ¤‘μΈ λ„μ‹μ λ²νΈ
        visited: ν„μ¬ λ°©λ¬Έν• λ„μ‹μ μ΅°ν•© (2μ§„μ μ •μ)
                 ex. 51(0b110011) => (1, 2, 5, 6)λ² λ„μ‹λ¥Ό λ°©λ¬Έν•¨.
    """
    # Nκ°μ λ„μ‹λ¥Ό λ‹¤ μνν• κ²½μ°
    if visited == (2 ** N - 1):
        # μ‹μ‘ λ„μ‹λ΅ λμ•„κ° μ μλ” κ²½λ΅κ°€ μλ‹¤λ©΄ => κ·Έ λΉ„μ©μ„ λ¦¬ν„΄ν•λ‹¤.
        if board[cnt][0]:
            return board[cnt][0]
        # μ‹μ‘ λ„μ‹λ΅ λμ•„κ° μ μλ” κ²½λ΅κ°€ μ—†λ‹¤λ©΄ infλ¥Ό λ°ν™ν•λ‹¤.
        return inf

    # ν„μ¬ μƒνƒμ—μ„ μνλ¥Ό λ§μΉλ” μµμ† λΉ„μ©μ„ μ΄μ „μ— κµ¬ν• κ²½μ°, ν•΄λ‹Ή λΉ„μ©μ„ λ¦¬ν„΄ν•λ‹¤.
    if costs[cnt][visited]:
        return costs[cnt][visited]

    # left_cost: λ‚¨μ€ μνλ¥Ό λ§μΉλ” μµμ† λΉ„μ©
    left_cost = inf

    for c in range(N):
        # μ•„μ§ cλ¥Ό λ°©λ¬Έν•μ§€ μ•μ•κ³ , ν„μ¬ μ„μΉμ—μ„ cλ΅ κ°€λ” κ²½λ΅κ°€ μλ‹¤λ©΄
        if not (visited & (1 << c)) and board[cnt][c]:
            # temp: ν„μ¬ μ„μΉμ—μ„ cλ΅ κ°€λ” λΉ„μ© + cλ΅ λ°©λ¬Έν• λ’¤ λ‚¨μ€ μνλ¥Ό λ§μΉλ” μµμ† λΉ„μ©
            temp = board[cnt][c] + get_min_cost(c, visited + (1 << c))
            left_cost = min(left_cost, temp)

    costs[cnt][visited] = left_cost
    return left_cost


# μ΄κΈ° μƒνƒ: 1λ² λ„μ‹λ§ λ°©λ¬Έν• μƒνƒ
print(get_min_cost(0, 1))
```

